---
import { SignedIn, SignedOut, UserButton, SignInButton } from "@clerk/astro/components";
import { navigation } from "@/consts";
import Checkout from "./react/checkout";
import NavbarDropdown from "./react/navbar-dropdown";
---

<header class="p-4 bg-black/20 backdrop-blur-md sticky top-0 z-50 flex items-center">
  <nav class="container mx-auto flex justify-between h-12 items-center gap-2">
    <ul class="hidden lg:block">
      {
        navigation.map((item) => (
          <li class="inline-block">
            <a href={item.href} class="text-white hover:bg-white/5 px-4 py-2 rounded transition-colors cursor-pointer">
              {item.name}
            </a>
          </li>
        ))
      }
    </ul>

    <a href="/">
      <img src="/assets/logo.webp" class="invert h-8 lg:h-12 object-contain" alt="SupraBox GNS" />
    </a>

    <SignedOut>
      <SignInButton
        class="px-4 shrink-0 py-2 rounded shadow hover:bg-white/5 active:bg-white/10 transition-colors cursor-pointer"
        mode="modal"
      >
        Iniciar Sesi√≥n
      </SignInButton>
    </SignedOut>
    <SignedIn>
      <div class="flex items-center gap-2">
        <UserButton
          showName
          appearance={{
            elements: {
              userButtonBox: " px-3 py-2 text-white ",
            },
          }}
          class:list={"px-4 py-2 rounded shadow"}
        />

        <Checkout client:load />
        <NavbarDropdown className="hover:opacity-90 cursor-pointer block lg:hidden" client:load />
      </div>
    </SignedIn>
  </nav>
</header>

<script>
  const details = document.getElementById("menu");

  document.addEventListener("click", (event) => {
    if (!details?.contains(event.target as Node)) {
      details?.removeAttribute("open");
    }
  });
</script>
